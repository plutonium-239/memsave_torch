Search.setIndex({"docnames": ["api/index", "api/nn", "api/nn/memsave_torch.nn.MemSaveBatchNorm2d", "api/nn/memsave_torch.nn.MemSaveConv2d", "api/nn/memsave_torch.nn.MemSaveLayerNorm", "api/nn/memsave_torch.nn.MemSaveLinear", "api/nn/memsave_torch.nn.MemSaveMaxPool2d", "api/nn/memsave_torch.nn.MemSaveReLU", "api/util/collect_results", "api/util/estimate", "api/util/index", "api/util/measurements", "api/util/models", "basic_usage", "index"], "filenames": ["api\\index.rst", "api\\nn.rst", "api\\nn\\memsave_torch.nn.MemSaveBatchNorm2d.rst", "api\\nn\\memsave_torch.nn.MemSaveConv2d.rst", "api\\nn\\memsave_torch.nn.MemSaveLayerNorm.rst", "api\\nn\\memsave_torch.nn.MemSaveLinear.rst", "api\\nn\\memsave_torch.nn.MemSaveMaxPool2d.rst", "api\\nn\\memsave_torch.nn.MemSaveReLU.rst", "api\\util\\collect_results.rst", "api\\util\\estimate.rst", "api\\util\\index.rst", "api\\util\\measurements.rst", "api\\util\\models.rst", "basic_usage.rst", "index.rst"], "titles": ["API Reference", "nn", "MemSaveBatchNorm2d", "MemSaveConv2d", "MemSaveLayerNorm", "MemSaveLinear", "MemSaveMaxPool2d", "MemSaveReLU", "ResultsCollector", "estimate.py", "util \u26a0\ufe0f", "&lt;no title&gt;", "Models", "Installation / Quickstart", "Welcome to MemSave PyTorch\u2019s documentation!"], "terms": {"util": [0, 8, 9, 12, 14], "packag": 0, "The": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13], "consist": 0, "two": 12, "main": 0, "thi": [1, 8, 9, 10, 12], "tri": 1, "mirror": 1, "torch": [1, 2, 3, 4, 5, 6, 7, 12, 13], "offer": 1, "follow": [1, 9], "layer": [2, 3, 4, 5, 6, 7, 9], "readili": 1, "replac": 1, "call": [1, 8, 12], "convert_to_memory_sav": [1, 13], "function": [1, 8, 9, 12, 13], "modul": [1, 9, 12, 13, 14], "contain": 1, "member": 1, "memsaveconv2d": [0, 1, 14], "memsavelinear": [0, 1, 14], "memsaverelu": [0, 1, 14], "memsavemaxpool2d": [0, 1, 14], "memsavebatchnorm2d": [0, 1, 14], "memsavelayernorm": [0, 1, 14], "memori": [1, 8, 9, 10, 12, 13], "save": [1, 8, 9, 13], "neural": 9, "network": [2, 3, 4, 5, 6, 7, 9], "current": [], "linear": [1, 5, 8, 9], "conv2d": [1, 3, 6], "batchnorm2d": [1, 2], "memsave_torch": [0, 1, 2, 3, 4, 5, 6, 7, 10, 12, 13], "model": [0, 1, 8, 9, 10, 13, 14], "true": [1, 2, 3, 4, 5, 9], "relu": [1, 7, 12], "maxpool2d": [1, 6], "layernorm": [1, 4], "verbos": 1, "fals": [1, 6, 9], "clone_param": 1, "convert": [1, 2, 3, 4, 5, 6, 7, 9], "given": [1, 2, 3, 4, 5, 6, 7, 8, 12], "": [1, 12], "memsav": 1, "version": 1, "option": [1, 8, 9], "choos": 1, "which": [1, 8, 9, 12], "type": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12], "should": 1, "us": [1, 8], "when": [1, 9], "you": 1, "plan": 1, "both": 1, "simultan": 1, "otherwis": [1, 12], "grad": [1, 9], "accumul": 1, "one": [0, 1, 9, 12], "wll": 1, "affect": 1, "other": 1, "sinc": 1, "weight": [1, 9], "ar": [1, 8], "same": [1, 9], "tensor": [1, 2, 3, 4, 5, 6, 7, 9], "object": [1, 2, 3, 4, 5, 6, 7, 12], "For": [1, 12], "an": [1, 9], "exampl": [1, 12], "see": [1, 9], "test": 1, "test_lay": 1, "py": [0, 1, 10, 14], "paramet": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12], "input": [1, 2, 3, 4, 5, 6, 7, 9], "bool": [1, 3, 9], "whether": [1, 9], "print": [1, 8, 9], "were": 1, "clone": 1, "directli": 1, "return": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12], "memsavemodel": 1, "class": [2, 3, 4, 5, 6, 7, 8], "in_channel": 3, "int": [3, 8], "out_channel": 3, "kernel_s": [3, 6], "stride": [3, 6], "1": [2, 3, 4, 6, 12], "pad": [3, 6], "0": [2, 3, 6], "dilat": [3, 6], "group": 3, "bia": [3, 4, 5], "padding_mod": 3, "str": [3, 8, 9, 12], "zero": 3, "devic": [2, 3, 4, 5, 8, 9], "none": [2, 3, 4, 5, 8, 9], "dtype": [2, 3, 4, 5], "init": [2, 3, 4, 5, 6, 7], "param": [2, 3, 4, 5, 6, 7], "forward": [2, 3, 4, 5, 6, 7, 9, 10], "pass": [2, 3, 4, 5, 6, 7, 9, 10, 13], "b": [2, 3, 4, 5, 6], "c_in": [3, 6], "h": [2, 3, 4, 6], "w": [2, 3, 4, 6], "output": [2, 3, 4, 5, 6, 7, 8, 12], "c_out": [3, 6], "h_out": [3, 6], "w_out": [3, 6], "classmethod": [2, 3, 4, 5, 6, 7], "from_nn_conv2d": 3, "obj": [2, 3, 4, 5, 6, 7], "in_featur": 5, "out_featur": 5, "x": [2, 4, 5, 7, 9], "f_in": 5, "f_out": 5, "from_nn_linear": 5, "from_nn_relu": 7, "return_indic": 6, "ceil_mod": 6, "from_nn_maxpool2d": 6, "num_featur": 2, "ep": [2, 4], "1e": [2, 4], "05": [2, 4], "momentum": 2, "affin": 2, "track_running_stat": 2, "c": [2, 4], "from_nn_batchnorm2d": 2, "bn2d": 2, "normalized_shap": 4, "elementwise_affin": 4, "introduc": 4, "v2": 4, "from_nn_layernorm": 4, "ln": 4, "A": 10, "collect": [8, 10], "script": [8, 9], "measur": [9, 10, 12], "time": [8, 9, 10], "consum": [9, 10], "dure": 10, "backward": [9, 10], "variou": [10, 12], "consumpt": [9, 10], "pip": 13, "git": 13, "http": 13, "github": 13, "com": 13, "plutonium": 13, "239": 13, "from": [8, 12, 13], "nn": [0, 2, 3, 4, 5, 6, 7, 13, 14], "i": [8, 9, 10, 13], "handi": 13, "tool": 13, "counterpart": 13, "import": 13, "my_torch_model": 13, "memsave_torch_model": 13, "instal": 14, "api": 14, "index": 14, "search": 14, "page": 14, "implement": [], "result": [8, 9], "estim": [0, 8, 10, 12, 14], "make": [8, 12], "datafram": 8, "all": [1, 8, 9], "case": [8, 9], "collect_result": 8, "resultscollector": [0, 10, 14], "batch_siz": 8, "input_channel": 8, "input_hw": 8, "num_class": 8, "architectur": [8, 9], "vjp_improv": 8, "list": [8, 9, 12], "float": 8, "results_dir": [8, 9], "callabl": [8, 9], "bound": 8, "method": 8, "tqdm": 8, "write": 8, "std": 8, "read": 8, "directori": 8, "initi": [8, 12], "collector": 8, "befor": 8, "run": [8, 9, 12], "conv": [8, 9], "union": 8, "base": 8, "dir": 8, "e": 8, "caus": [8, 9], "problem": 8, "context": 8, "clear_fil": 8, "clear": [8, 12], "temp": 8, "file": [8, 12], "after": [8, 9, 12], "stat": 8, "collect_from_fil": 8, "To": 8, "have": [8, 9, 12], "finish": 8, "name": [8, 12], "rais": 8, "descript": 12, "been": 8, "csv": 8, "hyperparam_str": 8, "arg": [8, 9], "simplenamespac": 8, "format": 8, "hyperparam": 8, "string": [8, 12], "make_case_str": 8, "possibl": 9, "speed": 9, "up": 9, "random": 9, "vjp": 9, "convolut": 9, "we": 9, "take": 9, "cnn": 9, "answer": 9, "question": 9, "q1": 9, "what": 9, "rel": 9, "q2": 9, "assum": 9, "achiev": 9, "would": 9, "optim": 9, "step": 9, "q3": 9, "term": 9, "estimate_mem_sav": 9, "model_fn": 9, "loss_fn": 9, "y": 9, "target": 9, "dict": [9, 12], "dev": 9, "return_v": 9, "set": 9, "loss": 9, "label": 9, "detect": 9, "comput": 9, "indic": 9, "valu": [9, 12], "default": 9, "requir": [9, 12], "onli": [8, 9], "estimate_speedup": 9, "total": 9, "train": 9, "parse_cas": 9, "small": 9, "helper": 9, "kw": 9, "argument": [9, 12], "dictionari": [9, 12], "kei": [9, 12], "allowed_cas": 9, "present": 9, "dont": 9, "start": 9, "no_": 9, "skip_case_check": 9, "namespac": 9, "decid": 9, "skip": 9, "ha": [8, 9], "grad_norm_": 9, "doe": [9, 12], "ani": 9, "normal": 9, "argpars": 9, "perform": [], "memorymeasur": [], "usag": [], "store": [], "after_forward": [], "grad_linear_weight": [], "grad_linear_bia": [], "grad_conv_weight": [], "grad_conv_bia": [], "grad_norm_weight": [], "grad_norm_bia": [], "grad_input": [], "gradient": [], "byte": [], "runtimemeasur": [], "forward_backward": [], "sync": [], "cuda": 12, "thread": [], "gpu": [], "second": [], "maybe_synchron": [], "synchron": [], "kernel": [], "pytorch": [], "separate_grad_argu": [], "tupl": [], "separ": 12, "leaf": [], "non": [], "first": [], "notimplementederror": [], "If": 8, "unknown": [], "encount": [], "defin": 12, "add": 12, "more": [8, 12], "conv_model_fn": 12, "detectionlosswrapp": [], "wrapper": [], "around": [], "support": [], "interop": [], "exist": [], "code": [], "loss_dict": [], "segmentationlosswrapp": [], "loss_fn_orig": [], "convert_to_memory_saving_defaultsoff": [], "extens": [], "off": [], "prefix_in_pair": 12, "prefix": 12, "each": 12, "entri": 12, "resnet101": 12, "convnext": 12, "memsave_": 12, "memsave_resnet101": 12, "memsave_convnext": 12, "ad": 12, "iter": 12, "item": 12, "pair": 12, "assertionerror": 8, "less": 8, "line": 8, "than": 8, "expect": 8, "number": 8, "valueerror": 8, "unallow": 8, "text": 8, "allow": 8, "handl": 8, "organ": 8, "gener": 8, "obsrev": 9, "peak": 9, "taken": 9, "till": 9, "map": 12, "wa": 12, "necessari": 12, "isol": 12, "being": [10, 12], "runtim": 12, "everi": 12, "singl": 12, "unless": 12, "absolut": 12, "even": 12, "empty_cach": 12, "veri": 12, "difficult": 12, "alexnet": 12, "convnext_bas": 12, "deeplabv3_resnet101": 12, "deepmodel": 12, "_conv_model1": 12, "deeprelumodel": 12, "_convrelu_model1": 12, "deeprelupoolmodel": 12, "_convrelupool_model1": 12, "efficientnet_v2_l": 12, "fasterrcnn_resnet50_fpn_v2": 12, "fcn_resnet101": 12, "memsave_alexnet": 12, "lambda": 12, "memsave_convnext_bas": 12, "memsave_deeplabv3_resnet101": 12, "memsave_deepmodel": 12, "_conv_model2": 12, "memsave_deeprelumodel": 12, "memsave_deeprelupoolmodel": 12, "memsave_efficientnet_v2_l": 12, "memsave_fasterrcnn_resnet50_fpn_v2": 12, "memsave_fcn_resnet101": 12, "memsave_mobilenet_v3_larg": 12, "memsave_resnet101_conv": 12, "bn": 12, "memsave_resnet101_conv_ful": 12, "memsave_resnet18": 12, "memsave_resnext101_64x4d": 12, "memsave_retinanet_resnet50_fpn_v2": 12, "memsave_ssdlite320_mobilenet_v3_larg": 12, "memsave_vgg16": 12, "mobilenet_v3_larg": 12, "resnet18": 12, "resnext101_64x4d": 12, "retinanet_resnet50_fpn_v2": 12, "ssdlite320_mobilenet_v3_larg": 12, "vgg16": 12, "new": 12, "empti": 12, "via": 12, "d": 12, "k": 12, "v": 12, "kwarg": 12, "keyword": 12, "2": 12, "conv1d": 1, "dropout": 1, "experi": [8, 9, 10, 12], "gpt2": 12, "memsave_gpt2": 12, "submodul": 10, "part": 10, "natur": 10, "subject": 10, "mainten": 10, "experiment": 10, "quickstart": 14, "refer": 14, "__init__": [], "attribut": [], "avail": 1, "warn": []}, "objects": {"experiments": [[10, 0, 0, "-", "util"]], "experiments.util": [[8, 0, 0, "-", "collect_results"], [9, 0, 0, "-", "estimate"], [12, 0, 0, "-", "models"]], "experiments.util.collect_results": [[8, 1, 1, "", "ResultsCollector"], [8, 3, 1, "", "hyperparam_str"], [8, 3, 1, "", "make_case_str"]], "experiments.util.collect_results.ResultsCollector": [[8, 2, 1, "", "clear_file"], [8, 2, 1, "", "collect_from_file"], [8, 2, 1, "", "finish"]], "experiments.util.estimate": [[9, 3, 1, "", "estimate_mem_savings"], [9, 3, 1, "", "estimate_speedup"], [9, 3, 1, "", "parse_case"], [9, 3, 1, "", "skip_case_check"]], "experiments.util.models": [[12, 4, 1, "", "conv_model_fns"], [12, 3, 1, "", "prefix_in_pairs"]], "": [[0, 0, 0, "-", "memsave_torch"]], "memsave_torch": [[1, 0, 0, "-", "nn"]], "memsave_torch.nn": [[2, 1, 1, "", "MemSaveBatchNorm2d"], [3, 1, 1, "", "MemSaveConv2d"], [4, 1, 1, "", "MemSaveLayerNorm"], [5, 1, 1, "", "MemSaveLinear"], [6, 1, 1, "", "MemSaveMaxPool2d"], [7, 1, 1, "", "MemSaveReLU"], [1, 3, 1, "", "convert_to_memory_saving"]], "memsave_torch.nn.MemSaveBatchNorm2d": [[2, 2, 1, "", "forward"], [2, 2, 1, "", "from_nn_BatchNorm2d"]], "memsave_torch.nn.MemSaveConv2d": [[3, 2, 1, "", "forward"], [3, 2, 1, "", "from_nn_Conv2d"]], "memsave_torch.nn.MemSaveLayerNorm": [[4, 2, 1, "", "forward"], [4, 2, 1, "", "from_nn_LayerNorm"]], "memsave_torch.nn.MemSaveLinear": [[5, 2, 1, "", "forward"], [5, 2, 1, "", "from_nn_Linear"]], "memsave_torch.nn.MemSaveMaxPool2d": [[6, 2, 1, "", "forward"], [6, 2, 1, "", "from_nn_MaxPool2d"]], "memsave_torch.nn.MemSaveReLU": [[7, 2, 1, "", "forward"], [7, 2, 1, "", "from_nn_ReLU"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:data"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "data", "Python data"]}, "titleterms": {"api": 0, "avail": 0, "modul": 0, "memsave_torch": [], "nn": 1, "implement": [], "layer": [1, 13], "learnabl": 1, "activ": 1, "pool": 1, "normal": 1, "util": 10, "instal": 13, "replac": 13, "all": 13, "valid": 13, "memsav": [13, 14], "welcom": 14, "pytorch": 14, "": 14, "document": 14, "get": 14, "start": 14, "indic": 14, "tabl": 14, "collect_result": [], "py": 9, "estim": 9, "class": 10, "script": 10, "resultscollector": 8, "model": 12, "quickstart": 13, "refer": 0, "memsaveconv2d": 3, "memsavelinear": 5, "laayer": [], "memsavebatchnorm2d": 2, "memsavelayernorm": 4, "memsavemaxpool2d": 6, "memsaverelu": 7, "experi": [], "warn": []}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 58}, "alltitles": {"API Reference": [[0, "api-reference"]], "Available Modules": [[0, null]], "MemSaveBatchNorm2d": [[2, "memsavebatchnorm2d"]], "MemSaveConv2d": [[3, "memsaveconv2d"]], "MemSaveLayerNorm": [[4, "memsavelayernorm"]], "MemSaveLinear": [[5, "memsavelinear"]], "MemSaveMaxPool2d": [[6, "memsavemaxpool2d"]], "MemSaveReLU": [[7, "memsaverelu"]], "ResultsCollector": [[8, "resultscollector"]], "estimate.py": [[9, "estimate-py"]], "Models": [[12, "models"]], "Installation / Quickstart": [[13, "installation-quickstart"]], "Replace all (valid) layers with MemSave layers": [[13, "replace-all-valid-layers-with-memsave-layers"]], "Welcome to MemSave PyTorch\u2019s documentation!": [[14, "welcome-to-memsave-pytorch-s-documentation"]], "Getting started": [[14, null]], "Indices and tables": [[14, "indices-and-tables"]], "nn": [[1, "nn"]], "Learnable Layers": [[1, "learnable-layers"]], "Activations and Pooling Layers": [[1, "activations-and-pooling-layers"]], "Normalization Layers": [[1, "normalization-layers"]], "util \u26a0\ufe0f": [[10, "util-warning"]], "Utility classes and scripts": [[10, null]]}, "indexentries": {"memsave_torch": [[0, "module-memsave_torch"]], "module": [[0, "module-memsave_torch"], [10, "module-experiments.util"]], "experiments.util": [[10, "module-experiments.util"]]}})